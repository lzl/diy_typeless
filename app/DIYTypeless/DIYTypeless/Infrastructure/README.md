# Infrastructure Layer

This layer contains external system integrations that don't belong in Domain or Data layers.

## Purpose

- FFI bridge to Rust core
- Scheduling and prefetching
- Any code that touches low-level system APIs

## Modules

### Scheduling/
Delayed task execution for prefetching selected text.

| Component | File | Purpose |
|-----------|------|---------|
| **PrefetchScheduler** | `Domain/Protocols/PrefetchScheduler.swift` | Protocol for scheduling |
| **RealPrefetchScheduler** | `Scheduling/RealPrefetchScheduler.swift` | Implementation |

### FFI Bridge
Rust core integration via UniFFI.

| File | Purpose |
|------|---------|
| `DIYTypelessCoreFFI.h` | C header generated by UniFFI |
| `DIYTypelessCoreFFI.modulemap` | Swift module map for FFI |

The FFI bridge is used by:
- Audio transcription (via Rust core)
- Any Rust-side processing

## Core Library

The Rust core lives in `/core/` directory. It provides:
- Audio processing
- ASR (Automatic Speech Recognition)
- Text polishing (via LLM)

## Usage

When AI needs to modify low-level behavior:
1. FFI calls are wrapped in Domain use cases
2. Direct FFI usage should be minimal
3. Check `Data/UseCases/TranscribeAudioUseCaseImpl` for FFI examples